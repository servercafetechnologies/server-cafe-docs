# 2.3 Software & Orchestration Setup

Software and orchestration setup transforms the installed hardware into a functioning Server Café node. This phase covers the installation of operating systems, container orchestration, Dawn–Day–Dusk orchestration layers, YAML-stamped protocols, and monitoring tools. All steps must be documented and verified before a node is certified for production.

---

## 2.3.1 Operating System Installation

**Objective:** Provide a hardened and consistent OS baseline across all servers.

**Procedure:**
- Use **Ubuntu Server LTS** or **RHEL Enterprise** (depending on licensing agreements).
- Apply security baselines:
  - Disable root SSH login.
  - Enforce key-based authentication only.
  - Configure SELinux (RHEL) or AppArmor (Ubuntu).
- Partition disks with:
  - `/` root: 100 GB.
  - `/var/log`: 200 GB (separate for log integrity).
  - `/data`: remaining capacity.
- Install latest kernel updates and apply patches.
- Validate system integrity with checksum verification.

**Deliverable:** An **OS Commissioning Report** with package lists, baseline configs, and hash verifications.

---

## 2.3.2 Container Orchestration

**Objective:** Standardize workloads and orchestration across all nodes.

**Procedure:**
- Install **Kubernetes (K8s)** cluster with at least 3 master nodes (commercial) or 1 master node (residential prototype).
- Configure namespaces:
  - `us-stack`.
  - `nato-stack`.
  - `global-stack`.
- Apply RBAC policies to segregate workloads by namespace.
- Deploy Helm charts for Dawn, Day, and Dusk orchestration layers.
- Validate pod resilience by simulating node failures.

**Deliverable:** A **Kubernetes Deployment Report** with namespace definitions, RBAC configs, and failover test logs.

---

## 2.3.3 Orchestration Layers (Dawn–Day–Dusk)

**Objective:** Deploy and configure the proprietary Server Café orchestration architecture.

**Procedure:**
- **Dawn Layer:**
  - Deploy input validation services.
  - Configure regex and ML-based sanitizers for inbound data.
  - Integrate with cybersecurity screening (NIST framework).
- **Day Layer:**
  - Deploy mediation services.
  - Configure connectors for multiple vendor APIs (OpenAI, Anthropic, Gemini, etc.).
  - Enable divergence detection and consensus arbitration.
- **Dusk Layer:**
  - Deploy compliance services.
  - Configure audit trail generator.
  - Apply industry-specific compliance modules (GDPR, HIPAA, SOX).

**Deliverable:** An **Orchestration Commissioning Report** confirming all three layers deployed, with functional test results.

---

## 2.3.4 Protocol Injection and Logging

**Objective:** Ensure all orchestration actions are logged and auditable.

**Procedure:**
- Implement YAML-stamped message protocol:
```yaml
message_type: internal_orchestration_message
from: Dawn
to: Day
purpose: input_validation
payload:
  validation_status: pass
  timestamp: 2025-08-22T14:05:00Z
```
- Configure all logs to:
  - Store locally in `/var/log/servercafe/`.
  - Ship to central log server (ELK stack).
  - Replicate across three physical racks for redundancy.
- Hash logs with SHA-256 and timestamp with NTP-synced clocks.

**Deliverable:** A **Protocol & Logging Verification Report** with sample YAML entries and hash validation records.

---

## 2.3.5 Monitoring Agents

**Objective:** Provide real-time observability of system health and performance.

**Procedure:**
- Install **Prometheus** for metrics collection.
- Configure **Grafana** dashboards:
  - CPU/memory utilization.
  - Solar yield and battery SOC.
  - HITL arbitration metrics.
- Deploy log shippers (Filebeat) to ELK.
- Integrate alerts with central SIEM.

**Deliverable:** A **Monitoring Commissioning Report** with screenshots of dashboards and alert simulations.

---

## 2.3.6 Validation and Handover

**Objective:** Certify that the software stack is ready for production workloads.

**Procedure:**
- Run integration test suite:
  - Input validation → mediation → compliance → logging.
  - Vendor API requests and consensus tests.
  - HITL arbitration drills.
- Verify monitoring and alerting fire correctly.
- Submit commissioning packet to Operations Lead and Compliance Officer.

**Deliverable:** A signed **Software & Orchestration Setup Certificate**, required before transitioning to Section 2.4 (Validation & Handover).

---
